<!DOCTYPE html>
<html lang="en">

<head>

  <title>Making FiveThirtyEight-like tables in Jupyter with Jinja2 and Pandas</title>
  
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <!-- Open Graph tags -->
  <meta property="og:locale" content="en_US">
  <meta property="og:site_name" content="A microbiologist with a data science problem"/>
  <meta property="article:author" content="Chuck Pepe-Ranney"/>

  <!-- Twitter card tags -->
  <meta name="twitter:card" content="summary"/>

  <meta name="twitter:creator" content="@chuckpr"/>

  <meta name="twitter:image" content="https://res.cloudinary.com/chuckpr-github-io/image/upload/v1596931735/twitter_card_image_pmtvbs.png"/>

  <link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css"/>

  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/site.css">

  <link rel="shortcut icon" type="image/x-icon" href="https://chuckpr.github.io/favicon.ico"/>
  <link rel="icon" type="image/x-icon" href="https://chuckpr.github.io/favicon.ico"/>


  <meta itemprop="description"
        name="description"
        content="I love the tables on FiveThirtyEight. I often want to similarly visualize a Pandas DataFrame …"/>

  <!-- Open Graph tags -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="Making FiveThirtyEight-like tables in Jupyter with Jinja2 and Pandas"/>
  <meta property="og:url" content="https://chuckpr.github.io/posts/fivethirtyeight-tables/"/>
  <meta property="og:image" content="https://res.cloudinary.com/chuckpr-github-io/image/upload/co_rgb:f2f2f2,w_470,c_fit,g_east,x_40,l_text:Helvetica_44_right:Making%20FiveThirtyEight-like%20tables%20in%20Jupyter%20with%20Jinja2%20and%20Pandas/blog_card_jieod8.png"/>
  <meta property="article:published_time" content="2020-05-04 00:00:00-04:00"/>
  <meta property="og:description"
        content="I love the tables on FiveThirtyEight. I often want to similarly visualize a Pandas DataFrame …"/>

  <!-- Twitter card tags -->
  <meta name="twitter:title" content="Making FiveThirtyEight-like tables in Jupyter with Jinja2 and Pandas">
  <meta name="twitter:description"
        content="I love the tables on FiveThirtyEight. I often want to similarly visualize a Pandas DataFrame …"/>

  <link rel="canonical" href="https://chuckpr.github.io/posts/fivethirtyeight-tables/">

  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/article.css">
    <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/extra/css/notebook.css">

</head>

<body>
  <header class="flex flex-column avenir mw7 ml-auto mr-auto">
<div class="pt5 pb2 pl0-l pl2">
  <a href="https://chuckpr.github.io/" class="link dim f2-ns f3 fw4 blue tracked-tight lh-title">
    A microbiologist with a data science problem
  </a>
</div>  </header>
  <main class="mw7 ml-auto mr-auto ph3 flex flex-column min-vh-100">
  <article class="flex flex-column">
    <section id="article-title" class="flex justify-between mt4 avenir bb b--moon-gray pb2">
      <div>
        <div class="flex flex-column">
          <div>
            <p class="f3-ns f4 mv0 lh-title">
              Making FiveThirtyEight-like tables in Jupyter with Jinja2 and Pandas
            </p>
          </div>
          <div class="ml3">
            <p class="f6 ttc mb0 mt1 mid-gray">
              Mon 04 May 2020
            </p>
          </div>
        </div>
      </div>
      <div class="w-40">
        <div class="flex flex-wrap justify-end">
<div class="mv1 mr2 bg-light-green br3 pa2 grow">
  <a href="https://chuckpr.github.io/tag/python" class="link dark-pink underline-hover fw5">
      #Python
  </a>
</div><div class="mv1 mr2 bg-light-green br3 pa2 grow">
  <a href="https://chuckpr.github.io/tag/jinja2" class="link dark-pink underline-hover fw5">
      #Jinja2
  </a>
</div>        </div>
      </div>
    </section>
    <section id="article-content" class="ph3 garamond near-black" style="font-size: 17px">
      <p>I love the tables on <a href="https://fivethirtyeight.com/">FiveThirtyEight</a>. I often want to similarly visualize a <a href="https://pandas.pydata.org/">Pandas DataFrame</a> in <a href="https://jupyter.org/">Jupyter</a>. In this post we'll take a shot at creating a FiveThirtyEight-styled table in a Jupyter notebook. Let's make a something like this <a href="https://projects.fivethirtyeight.com/congress-generic-ballot-polls/">table of 2020 congressional race polls</a>. Pandas has a great <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html">styling API</a> but it's not enough to achieve all the styling touches that FiveThirtyEight uses. Instead of using the Pandas styling API, we'll create an <code>HTML</code> table from scratch using a <a href="https://jinja.palletsprojects.com/en/2.11.x/">Jinja</a> template that will accept polls data and return a styled <code>HTML</code> table.</p>



<p>Here's a quick demonstration.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Template</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>

<p>Let's make a little toy DataFrame. This is how the DataFrame is rendered by default:</p>



<div class=" celltag_aside">
<p>Every now and then I'll be applying a <code>CSS</code> class from the <a href="https://tachyons.io/">Tachyons <code>CSS</code> framework</a> which I use to style this blog. In the table below I'm adding a Tachyons class "collapse" tot the <code>HTML</code> output from Pandas.</p>

</div>

<div class="cell border-box-sizing code_cell rendered celltag_center">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span>
        <span class="n">letter</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span>
        <span class="n">other_data</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="s2">&quot;collapse&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe collapse">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>letter</th>
      <th>other_data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>

<p><strong>Not very aesthetically interesting...</strong></p>



<p>Let's say we want to draw a red circle around all the "a" values. We can do this easily with <code>HTML</code> and <code>CSS</code>.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%html
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;border: thin solid red; border-radius: 50%; width: 24px; text-align: center&quot;</span><span class="p">&gt;</span>
a
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div style="border: thin solid red; border-radius: 50%; width: 24px; text-align: center">
a
</div>

</div>

</div>

</div>
</div>

</div>

<p>But we don't want to hand code <code>HTML</code> for an entire table. This is where Jinja comes in. We can create a Jinja <em>template</em> for our <code>HTML</code> table that will loop through our data and output the full table. The code below builds a Jinja template that accepts <code>rows</code> — which is a list of dictionaries representing our DataFrame rows — and, <code>columns</code> — which is a list that represents our DataFrame column names. The template takes the input data and returns an <code>HTML</code> table. For a review of the Jinja template syntax check out <a href="https://jinja.palletsprojects.com/en/2.11.x/">the documentation</a>. Templating systems are incredibly powerful so it's well worth your time.</p>



<div class=" celltag_aside">
<p>I added the <code>collapse</code> class again to the table which is defined in the <a href="https://tachyons.io/docs/elements/tables/">CSS framework</a> I'm using on this blog. The <code>collapse</code> class adjusts the cell/table borders so they aren't doubled in appearance.</p>

</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;table class=&quot;example collapse&quot;&gt;</span>
<span class="s1">  &lt;thead&gt;</span>
<span class="s1">    &lt;tr&gt;</span>
<span class="s1">      {</span><span class="si">% f</span><span class="s1">or c in columns %}</span>
<span class="s1">      &lt;th&gt;{{ c }}&lt;/th&gt;</span>
<span class="s1">      {</span><span class="si">% e</span><span class="s1">ndfor %}</span>
<span class="s1">    &lt;/tr&gt;</span>
<span class="s1">  &lt;/thead&gt;</span>
<span class="s1">  &lt;tbody&gt;</span>
<span class="s1">     {</span><span class="si">% f</span><span class="s1">or row in rows %}</span>
<span class="s1">     &lt;tr&gt;</span>
<span class="s1">     {</span><span class="si">% f</span><span class="s1">or k, v in row.items() %}</span>
<span class="s1">     {</span><span class="si">% i</span><span class="s1">f v == &#39;a&#39; %}</span>
<span class="s1">     &lt;td&gt;&lt;div class=&quot;red-circle&quot;&gt;{{ row.letter }}&lt;/div&gt;&lt;/td&gt;</span>
<span class="s1">     {</span><span class="si">% e</span><span class="s1">lse %}</span>
<span class="s1">     &lt;td&gt;&lt;div&gt;{{ v }}&lt;/div&gt;&lt;/td&gt;</span>
<span class="s1">     {</span><span class="si">% e</span><span class="s1">ndif %}</span>
<span class="s1">     {</span><span class="si">% e</span><span class="s1">ndfor %}</span>
<span class="s1">     &lt;/tr&gt;</span>
<span class="s1">     {</span><span class="si">% e</span><span class="s1">ndfor %}</span>
<span class="s1">   &lt;/tr&gt;</span>
<span class="s1">  &lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>

<p>I think the <code>HTML</code> table markup is pretty intuitive: nested in <code>&lt;table&gt;</code> we have a table header <code>&lt;thead&gt;</code> and a body <code>&lt;tbody&gt;</code> and so on. The Jinja magic is happening in the curly braced bits (e.g. <code>{% for k, v in row.items() %}</code>). <strong>Jinja lets us use <code>Python</code> syntax to generate <code>HTML</code></strong>. <code>CSS</code>, on the other hand, feels pretty foreign at first but you get the hang of it. Let's append some <code>CSS</code> styles to our template. The styles below are what make the <code>red-circle</code> <code>divs</code> (see above) actually into <span style="color:red">red circles</span>.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template_str</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;style&gt;</span>

<span class="s1">table.example {</span>
<span class="s1">  border: thin solid lightgray;</span>
<span class="s1">}</span>

<span class="s1">table.example th,</span>
<span class="s1">table.example td {</span>
<span class="s1">  border: thin solid lightgray;</span>
<span class="s1">  min-width: 75px;</span>
<span class="s1">  text-align: center;</span>
<span class="s1">  padding: 5px;</span>
<span class="s1">}</span>

<span class="s1">table.example .red-circle {</span>
<span class="s1">  border: thin solid red;</span>
<span class="s1">  width: 24px;</span>
<span class="s1">  height: 24px;</span>
<span class="s1">  border-radius: 50%;</span>
<span class="s1">  text-align: center;</span>
<span class="s1">  margin: auto;</span>
<span class="s1">}</span>
<span class="s1">&lt;/style&gt;</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>

<p>All that's left is to feed the data from our toy DataFrame to the template. Again, this is pretty intuitive syntax (one of the great features of Jinja).</p>


<div class="cell border-box-sizing code_cell rendered celltag_center">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">template_str</span><span class="p">)</span>

<span class="n">html</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

<table class="example collapse">
  <thead>
    <tr>

      <th>letter</th>

      <th>other_data</th>

    </tr>
  </thead>
  <tbody>

     <tr>


     <td><div class="red-circle">a</div></td>



     <td><div>3</div></td>


     </tr>

     <tr>


     <td><div>b</div></td>



     <td><div>56</div></td>


     </tr>

     <tr>


     <td><div>b</div></td>



     <td><div>3</div></td>


     </tr>

     <tr>


     <td><div class="red-circle">a</div></td>



     <td><div>1</div></td>


     </tr>

   </tr>
  </tbody>
</table>

<style>

table.example {
  border: thin solid lightgray;
}

table.example th,
table.example td {
  border: thin solid lightgray;
  min-width: 75px;
  text-align: center;
  padding: 5px;
}

table.example .red-circle {
  border: thin solid red;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  text-align: center;
  margin: auto;
}
</style>
</div>

</div>

</div>
</div>

</div>

<h2 id="The-FiveThiryEight-example">The FiveThiryEight example<a class="anchor-link" href="#The-FiveThiryEight-example"> &#8678;</a></h2>


<p><strong>Ok we've got the gist of it now let's apply the same technique to re-create a FiveThirtyEight-like table.</strong> I'm going to try to make <a href="https://projects.fivethirtyeight.com/congress-generic-ballot-polls/">this table</a> of polls data for 2020 US congressional elections. I prepared a <code>Jinja</code> template, <code>fivethirtyeight.tpl</code>, that we'll use to create our table (I've shared the template in this <a href="https://gist.github.com/chuckpr/191383974ec46769b877427d5b06ad9b">GitHub gist</a>). Before we can use the template, we have to prepare our data. The polls data is <a href="https://projects.fivethirtyeight.com/generic-ballot-data/generic_polllist.csv">linked right in the FiveThiryEight page</a> (super convenient!).</p>



<p>Below are some formatting functions I'm applying to the FiveThirtyEight polls data to prep it for our Jinja template. I'm just calculating colors and "prettifying" other values.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">format_dates</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/%Y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/%Y&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b.&amp;nbsp</span><span class="si">%d</span><span class="s1">-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b.&amp;nbsp</span><span class="si">%d</span><span class="s1">-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b.&amp;nbsp</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">add_comma</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_leader</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">lead</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="n">r</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">party</span> <span class="o">=</span> <span class="s1">&#39;Democrat&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fmt</span><span class="p">(</span><span class="n">party</span><span class="p">)</span><span class="si">}</span><span class="s1">&amp;nbsp+</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lead</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">party</span> <span class="o">=</span> <span class="s1">&#39;Republican&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fmt</span><span class="p">(</span><span class="n">party</span><span class="p">)</span><span class="si">}</span><span class="s1">&amp;nbsp+</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">no</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lead</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span>
    
<span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;red&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;rgba(255, 0, 0, </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">)&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;rgba(0, 0, 255, </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">)&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>

<p>Now we'll read our data into a Pandas DataFrame and send it through all the formatting steps.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">formatted_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/generic_polllist.csv&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dates</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">format_dates</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> 
                             <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> 
                             <span class="n">x</span><span class="p">[[</span><span class="s1">&#39;startdate&#39;</span><span class="p">,</span> <span class="s1">&#39;enddate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;samplesize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">add_comma</span><span class="p">))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">republican</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;rep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">democrat</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;dem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">leader</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">get_leader</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> 
                                <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> 
                                <span class="n">x</span><span class="p">[[</span><span class="s1">&#39;dem&#39;</span><span class="p">,</span> <span class="s1">&#39;rep&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">adj_leader</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">get_leader</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span> 
                                    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> 
                                    <span class="n">x</span><span class="p">[[</span><span class="s1">&#39;dem&#39;</span><span class="p">,</span> <span class="s1">&#39;rep&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">d_color</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;dem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">get_color</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">r_color</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;rep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">get_color</span><span class="p">))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>

<p>Finally we can pass the data to our Jinja template and enjoy the show! I'm just displaying fifteen rows below and I've selected one row per pollster.</p>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_rows</span> <span class="o">=</span> <span class="mi">15</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight.tpl&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">rows</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">formatted_df</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;pollster&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
<span class="p">)[:</span><span class="n">N_rows</span><span class="p">]</span>
    
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">,</span> <span class="s1">&#39;pollster&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;republican&#39;</span><span class="p">,</span>
        <span class="s1">&#39;democrat&#39;</span><span class="p">,</span> <span class="s1">&#39;leader&#39;</span><span class="p">,</span> <span class="s1">&#39;adjusted leader&#39;</span><span class="p">]</span>    
    
<span class="n">html</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

<div class="polls3">
  <table>
    <thead>
      <tr>

        <th><div >
          dates</div>
        </th>

        <th><div >
          pollster</div>
        </th>

        <th><div 
                   style="text-align: center"
                 >
          grade</div>
        </th>

        <th><div 
                   style="text-align: center"
                 >
          sample</div>
        </th>

        <th><div 
                   style="text-align: center"
                 >
          weight</div>
        </th>

        <th class="rotate">
          <div>
            <svg width="82" height="82" style="max-width: none;">
              <text transform="translate(25,60)rotate(-45)" x="0" y="0">republican</text>
              <line x1="0" y1="65" x2="25" y2="40" transform="translate(41.5,0)"></line>
            </svg>
          </div>
        </th>
        <th class="rotate">
          <div>
            <svg width="82" height="82" style="max-width: none;">
              <text transform="translate(25,60)rotate(-45)" x="0" y="0">democrat</text>
            </svg>
          </div>
        </th>
        <th style="width: 20px"></th>

        <th><div>leader</div></th>

        <th><div>adjusted leader</div></th>

      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="dates">Sep.&nbsp26-27</td>
        <td class="justtext">ALG Research/GBAO</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: white"></div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,013<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.84</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">39%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">47%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+8</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+8
        </td>
      </tr>

      <tr>
        <td class="dates">Jun.&nbsp03-06</td>
        <td class="justtext">Basswood Research</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">B/C</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,200<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.3</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">42%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">44%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+2</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+2
        </td>
      </tr>

      <tr>
        <td class="dates">Mar.&nbsp04-07</td>
        <td class="justtext">CNN/SSRS</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">A/B</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,084<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.52</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.35)">44%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.6)">53%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+9</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+9
        </td>
      </tr>

      <tr>
        <td class="dates">Aug.&nbsp07-10</td>
        <td class="justtext">Cygnal</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">A/B</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,263<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.69</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">39%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">46%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+7</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+7
        </td>
      </tr>

      <tr>
        <td class="dates">Feb.&nbsp22-23</td>
        <td class="justtext">D-CYFOR</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: white"></div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,000<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.84</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">39%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">46%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+7</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+7
        </td>
      </tr>

      <tr>
        <td class="dates">Nov.&nbsp20-Dec.&nbsp03</td>
        <td class="justtext">Data for Progress</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">B/C</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            980<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.88</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">39%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">47%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+8</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+8
        </td>
      </tr>

      <tr>
        <td class="dates">Jan.&nbsp20-21</td>
        <td class="justtext">Emerson College</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">A-</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            942<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.4</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.35)">47%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.475)">52%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+5</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+5
        </td>
      </tr>

      <tr>
        <td class="dates">Mar.&nbsp21-28</td>
        <td class="justtext">Firehouse Strategies/Øptimus</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">C/D</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,032<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.31</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.1)">36%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">47%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+10</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+10
        </td>
      </tr>

      <tr>
        <td class="dates">Aug.&nbsp15-21</td>
        <td class="justtext">GQR Research</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">C+</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            2,629<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.13</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">41%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.475)">49%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+8</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+8
        </td>
      </tr>

      <tr>
        <td class="dates">Mar.&nbsp31-Apr.&nbsp04</td>
        <td class="justtext">Georgetown University/Battleground</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">A/B</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,000<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.54</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.1)">37%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.225)">42%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+5</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+5
        </td>
      </tr>

      <tr>
        <td class="dates">Nov.&nbsp01-08</td>
        <td class="justtext">Global Strategy Group</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">B/C</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            800<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.88</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">42%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.475)">49%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+7</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+7
        </td>
      </tr>

      <tr>
        <td class="dates">Dec.&nbsp31-Jan.&nbsp02</td>
        <td class="justtext">HarrisX</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">C+</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            3,012<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 60%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.04</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.1)">35%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">45%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+10</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+10
        </td>
      </tr>

      <tr>
        <td class="dates">Oct.&nbsp03-09</td>
        <td class="justtext">Hart Research Associates</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">B/C</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,000<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">1.2</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.1)">38%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">47%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+9</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+9
        </td>
      </tr>

      <tr>
        <td class="dates">Oct.&nbsp03-08</td>
        <td class="justtext">Marist College</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">A+</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            926<span style="color: #999">&nbsprv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: gray">
            </div>
            <div class="bar" 
             style="height: 100%; background: gray">
            </div>
          </div>
          <div style="margin-right: 10px">1.7</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.225)">40%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.225)">43%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+3</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+3
        </td>
      </tr>

      <tr>
        <td class="dates">Feb.&nbsp06-10</td>
        <td class="justtext">McLaughlin & Associates</td>
        <td class="grade">

          <div class="grade-circ" style="border-color: green">
            <div style="position: relative; top: 25%">C/D</div>
          </div>

        </td>
        <td class="sample">
          <div class="sample-number">
            1,000<span style="color: #999">&nbsplv</span>
          </div>
        </td>
        <td class="weight">
          <div class="signal">
            <div class="bar" 
             style="height: 20%; background: gray">
            </div>
            <div class="bar" 
             style="height: 40%; background: gray">
            </div>
            <div class="bar" 
             style="height: 60%; background: gray">
            </div>
            <div class="bar" 
             style="height: 80%; background: lightgray">
            </div>
            <div class="bar" 
             style="height: 100%; background: lightgray">
            </div>
          </div>
          <div style="margin-right: 10px">0.58</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(255, 0, 0, 0.35)">45%</div>
        </td>
        <td class="heat">
          <div style="background-color: rgba(0, 0, 255, 0.35)">46%</div>
        </td>
        <td style="min-width: 10px;"></td>
        <td class="just-text">Democrat&nbsp+1</td>
        <td class="adj-leader" 
            style="color: #008fd5">
          D.&nbsp+1
        </td>
      </tr>

    </tbody>
  </table>
</div>

<style>

div .polls3 {
    overflow: scroll;
    margin-top: 6px;
}

.polls3 table {
    font-family: 'helvetica neue', helvetica, sans-serif;
    font-size: 12px;
    font-weight: 500;
    border-collapse: collapse;
    border-spacing: 0;
}

.polls3 table thead tr {
    border-bottom: 1px solid #222;
}

.polls3 table thead tr th {
    text-transform: uppercase;
    font-weight: 500;
    vertical-align: bottom;
    text-align: left !important;
}

.polls3 table thead tr th.rotate {
    height: 65px;
    width: 41px;
    padding: 0;
    position: relative;
}

.polls3 table thead tr th.rotate>div {
    position: absolute;
    left: 0;
    top: 0;
}

.polls3 table thead tr th.rotate>div svg line {
    stroke-width: 1;
    stroke: #cdcdcd;
}

.polls3 table tbody tr td {
    vertical-align: middle;
}

.polls3 table tbody tr td.dates {
    padding-left: 5px;
    min-width: 90px;
    font-size: 11px;
    text-transform: uppercase;
    color: #999;
    text-align: left;
}

.polls3 table tbody tr td.just-text {
    padding-left: 5px;
    min-width: 80px;
    font-size: 13px;
    text-align: left;
}

.polls3 table tbody tr td.grade {
    text-align: center;
    padding-left: 10px;
    border-right: 1px solid #222;
    width: 70px;
    min-width: 70px;
    font-size: 11px;
}

.polls3 table tbody tr td.grade>div {
    border: 2px solid;
    border-radius: 50%;
    height: 30px;
    width: 30px;
    font-weight: bold;
    margin-left: auto;
    margin-right: auto;
}

.polls3 table tbody tr td.sample {
    width: 65px;
    min-width: 65px;
    font-size: 13px;
    text-align: right;
    font-family: "DecimaMonoPro", monospace;
    margin-right: 5px;
    padding-left: 5px;
    text-transform: uppercase;
}

.polls3 table tbody tr td.weight {
    font-size: 13px;
    text-align: right;
    font-family: "DecimaMonoPro", monospace;
    width: 90px;
    min-width: 90px;
    border-right: 1px solid #222;
    text-transform: uppercase;
    padding-left: 5px;
}

.signal {
    width: 35px;
    height: 18px;
    margin: 0;
    padding: 0;
    display: table;
    float: left;
}

.bar {
    margin-left: 5%;
    padding: 0;
    vertical: align-bottom;
    width: 12%;
    display: inline-block;
}

.polls3 table tbody tr td.heat {
    padding: 0;
}

.polls3 table tbody tr td.heat>div {
    width: 40px;
    min-width: 40px;
    height: 50px;
    font-family: "DecimaMonoPro", monospace;
    font-size: 13px;
    display: table-cell;
    vertical-align: middle;
    text-align: center;
}

.polls3 table tbody tr td.adj-leader {
    width: 65px;
    min-width: 65px;
    font-weight: 700;
    font-size: 13px;
    text-align: left;
    padding-left: 5px;
}

</style>
</div>

</div>

</div>
</div>

</div>

<p>This looks great! I am especially pleased with the little <code>weight</code> icons. It's not trivial to produce such detailed styling but <strong>the effort really brings the data to life.</strong></p>



<h2 id="Bonus:-styling-the-table-header">Bonus: styling the table header<a class="anchor-link" href="#Bonus:-styling-the-table-header"> &#8678;</a></h2>


<p>Here's how I created the table header. It was tedious work but I was eventually able to wrap my head around how FiveThirtyEight achieves that rotated text effect in table column headers. The rotated column style is produced with a combination of <code>SVG</code> transforms and <code>CSS</code> positioning. We'll begin with the <code>SVG</code>.</p>



<div class=" celltag_aside">
<p>You can render <code>SVG</code> directly in your notebook using the <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#cellmagic-svg"><code>SVG</code> magic command</a> but I like to use <a href="https://codepen.io">CodePen</a> for rapid <code>HTML/CSS</code> prototyping.</p>

</div>

<div class="cell border-box-sizing code_cell rendered celltag_hide-code celltag_codepen">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%html
<span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;codepen&quot;</span> <span class="na">data-height</span><span class="o">=</span><span class="s">&quot;248&quot;</span> <span class="na">data-theme-id</span><span class="o">=</span><span class="s">&quot;light&quot;</span> <span class="na">data-default-tab</span><span class="o">=</span><span class="s">&quot;html,result&quot;</span> <span class="na">data-user</span><span class="o">=</span><span class="s">&quot;chuckpr&quot;</span> <span class="na">data-slug-hash</span><span class="o">=</span><span class="s">&quot;ZEbyjom&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height: 248px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;&quot;</span> <span class="na">data-pen-title</span><span class="o">=</span><span class="s">&quot;header-rotation-1&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>See the Pen <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr/pen/ZEbyjom&quot;</span><span class="p">&gt;</span>
  header-rotation-1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> by Charles Pepe-Ranney (<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr&quot;</span><span class="p">&gt;</span>@chuckpr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)
  on <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io&quot;</span><span class="p">&gt;</span>CodePen<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://static.codepen.io/assets/embed/ei.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<p class="codepen" data-height="248" data-theme-id="light" data-default-tab="html,result" data-user="chuckpr" data-slug-hash="ZEbyjom" style="height: 248px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="header-rotation-1">
  <span>See the Pen <a href="https://codepen.io/chuckpr/pen/ZEbyjom">
  header-rotation-1</a> by Charles Pepe-Ranney (<a href="https://codepen.io/chuckpr">@chuckpr</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

</div>

</div>

</div>
</div>

</div>

<p>It helps to add some orienting elements to understand how this <code>SVG</code> "works." Let's draw it again with a gray background, and a couple lines meant to show the X (<span style="color:green">green</span>) and Y (<span style="color:blue">blue</span>) orientation.</p>


<div class="cell border-box-sizing code_cell rendered celltag_hide-code celltag_codepen">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%html
<span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;codepen&quot;</span> <span class="na">data-height</span><span class="o">=</span><span class="s">&quot;265&quot;</span> <span class="na">data-theme-id</span><span class="o">=</span><span class="s">&quot;light&quot;</span> <span class="na">data-default-tab</span><span class="o">=</span><span class="s">&quot;html,result&quot;</span> <span class="na">data-user</span><span class="o">=</span><span class="s">&quot;chuckpr&quot;</span> <span class="na">data-slug-hash</span><span class="o">=</span><span class="s">&quot;BaoZPPd&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;&quot;</span> <span class="na">data-pen-title</span><span class="o">=</span><span class="s">&quot;header-rotation-2&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>See the Pen <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr/pen/BaoZPPd&quot;</span><span class="p">&gt;</span>
  header-rotation-2<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> by Charles Pepe-Ranney (<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr&quot;</span><span class="p">&gt;</span>@chuckpr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)
  on <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io&quot;</span><span class="p">&gt;</span>CodePen<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://static.codepen.io/assets/embed/ei.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<p class="codepen" data-height="265" data-theme-id="light" data-default-tab="html,result" data-user="chuckpr" data-slug-hash="BaoZPPd" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="header-rotation-2">
  <span>See the Pen <a href="https://codepen.io/chuckpr/pen/BaoZPPd">
  header-rotation-2</a> by Charles Pepe-Ranney (<a href="https://codepen.io/chuckpr">@chuckpr</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

</div>

</div>

</div>
</div>

</div>

<p>The text positioning happens in the <code>transform</code> attribute which is set to <code>"translate(25,60)rotate(-45)"</code>. This transform is rotating the text by <code>-45˚</code> and moving it down <code>60</code> units and right <code>25</code> units. <em>Note how "down" and "up" are relative to the orientation of the text <strong>after</strong> rotation <strong>not</strong> the orientation of the <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/viewBox">viewbox</a></em>.</p>



<p>Our column header element <code>th</code> will contain a <code>div</code> and this <code>div</code> will hold the <code>SVG</code> that defines our table header text. The trick is to position the <code>SVG</code> inside the <code>div</code> so it's flush with the table header cell by adding  <code>position: absolute; left: 0, top: 0</code> styles to the <code>SVG</code>. You also have to set a height on the table header cell that works with your <code>SVG transform</code> (in this case <code>height: 65px</code>). Essentially this lets our <code>SVG</code> position the text <em>in the table header element</em>. In the example below the gray background shows the bounds of our table header cell and the red border surrounds our <code>SVG</code>.</p>


<div class="cell border-box-sizing code_cell rendered celltag_codepen celltag_hide-code">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%html
<span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;codepen&quot;</span> <span class="na">data-height</span><span class="o">=</span><span class="s">&quot;265&quot;</span> <span class="na">data-theme-id</span><span class="o">=</span><span class="s">&quot;light&quot;</span> <span class="na">data-default-tab</span><span class="o">=</span><span class="s">&quot;html,result&quot;</span> <span class="na">data-user</span><span class="o">=</span><span class="s">&quot;chuckpr&quot;</span> <span class="na">data-slug-hash</span><span class="o">=</span><span class="s">&quot;yLYXdWQ&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;&quot;</span> <span class="na">data-pen-title</span><span class="o">=</span><span class="s">&quot;header-rotation-3&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>See the Pen <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr/pen/yLYXdWQ&quot;</span><span class="p">&gt;</span>
  header-rotation-3<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> by Charles Pepe-Ranney (<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr&quot;</span><span class="p">&gt;</span>@chuckpr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)
  on <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io&quot;</span><span class="p">&gt;</span>CodePen<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://static.codepen.io/assets/embed/ei.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<p class="codepen" data-height="265" data-theme-id="light" data-default-tab="html,result" data-user="chuckpr" data-slug-hash="yLYXdWQ" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="header-rotation-3">
  <span>See the Pen <a href="https://codepen.io/chuckpr/pen/yLYXdWQ">
  header-rotation-3</a> by Charles Pepe-Ranney (<a href="https://codepen.io/chuckpr">@chuckpr</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

</div>

</div>

</div>
</div>

</div>

<p>The rest of the table header is pretty straightforward: left-aligned, uppercase text. I made a minimal Jinja template for the header and we can see it in action below. <strong>I really like the rotated text — it's readable and allows for narrow heatmap cells because of the reduced width.</strong></p>


<div class="cell border-box-sizing code_cell rendered celltag_hide-all">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">header_template</span><span class="o">.</span><span class="n">tpl</span>

<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;polls2&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">table</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">thead</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">c</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;rotate&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">svg</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;max-width: none;&quot;</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">text</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(25,60)rotate(-45)&quot;</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]}}</span><span class="o">&lt;/</span><span class="n">text</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">line</span> <span class="n">x1</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y1</span><span class="o">=</span><span class="s2">&quot;65&quot;</span> <span class="n">x2</span><span class="o">=</span><span class="s2">&quot;25&quot;</span> <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;40&quot;</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(41.5,0)&quot;</span><span class="o">&gt;&lt;/</span><span class="n">line</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">svg</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;rotate&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">svg</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;max-width: none;&quot;</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">text</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(25,60)rotate(-45)&quot;</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">]}}</span><span class="o">&lt;/</span><span class="n">text</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">svg</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">c</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
      <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">thead</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;margin-bottom: 20px;&quot;</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>

<span class="n">div</span><span class="o">.</span><span class="n">polls2</span> <span class="p">{</span>
    <span class="n">overflow</span><span class="p">:</span> <span class="n">scroll</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">top</span><span class="p">:</span> <span class="mi">20</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="p">{</span>
    <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="s1">&#39;helvetica neue&#39;</span><span class="p">,</span> <span class="n">helvetica</span><span class="p">,</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">12</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="mi">500</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">collapse</span><span class="p">:</span> <span class="n">collapse</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">spacing</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="p">{</span>
    <span class="n">border</span><span class="o">-</span><span class="n">bottom</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#222;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">transform</span><span class="p">:</span> <span class="n">uppercase</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="mi">500</span><span class="p">;</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">bottom</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">left</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">60</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span> <span class="p">{</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">41</span><span class="n">px</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">relative</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span><span class="o">&gt;</span><span class="n">div</span> <span class="p">{</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">absolute</span><span class="p">;</span>
    <span class="n">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls2</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span><span class="o">&gt;</span><span class="n">div</span> <span class="n">svg</span> <span class="n">line</span> <span class="p">{</span>
    <span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">stroke</span><span class="p">:</span> <span class="c1">#cdcdcd;</span>
<span class="p">}</span>

<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting header_template.tpl
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Template</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;header_template.tpl&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">file_</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">,</span> <span class="s1">&#39;pollster&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;republican&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;democrat&#39;</span><span class="p">,</span> <span class="s1">&#39;leader&#39;</span><span class="p">,</span> <span class="s1">&#39;adjusted leader&#39;</span><span class="p">]</span>
    
<span class="n">html</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

<div class="polls2">
  <table>
    <thead>
      <tr>

        <th><div>dates</div></th>

        <th><div>pollster</div></th>

        <th><div>grade</div></th>

        <th><div>sample</div></th>

        <th><div>weight</div></th>

        <th class="rotate">
          <div>
            <svg width="82" height="82" style="max-width: none;">
              <text transform="translate(25,60)rotate(-45)" x="0" y="0">republican</text>
              <line x1="0" y1="65" x2="25" y2="40" transform="translate(41.5,0)"></line>
            </svg>
          </div>
        </th>
        <th class="rotate">
          <div>
            <svg width="82" height="82" style="max-width: none;">
              <text transform="translate(25,60)rotate(-45)" x="0" y="0">democrat</text>
            </svg>
          </div>
        </th>

        <th><div>leader</div></th>

        <th><div>adjusted leader</div></th>

      </tr>
    </thead>
  </table>
</div style="margin-bottom: 20px;">

<style>

div.polls2 {
    overflow: scroll;
    margin-top: 20px;
}

.polls2 table {
    font-family: 'helvetica neue', helvetica, sans-serif;
    font-size: 12px;
    font-weight: 500;
    border-collapse: collapse;
    border-spacing: 0;
}

.polls2 table thead tr {
    border-bottom: 1px solid #222;
}

.polls2 table thead tr th {
    text-transform: uppercase;
    font-weight: 500;
    vertical-align: bottom;
    text-align: left;
    min-width: 60px;
}

.polls2 table thead tr th.rotate {
    height: 65px;
    width: 41px;
    padding: 0;
    position: relative;
}

.polls2 table thead tr th.rotate>div {
    position: absolute;
    left: 0;
    top: 0;
}

.polls2 table thead tr th.rotate>div svg line {
    stroke-width: 1;
    stroke: #cdcdcd;
}

</style>
</div>

</div>

</div>
</div>

</div>

<h2 id="Bonus:-making-the-&quot;signal-strength&quot;-icon">Bonus: making the "signal strength" icon<a class="anchor-link" href="#Bonus:-making-the-&quot;signal-strength&quot;-icon"> &#8678;</a></h2>


<p>The "signal strengh" icon in the <code>weight</code> column is a nice touch. This icon can be created simply with <code>div</code> elements. Here's how I did it:</p>


<div class="cell border-box-sizing code_cell rendered celltag_codepen celltag_hide-code">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%html
<span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;codepen&quot;</span> <span class="na">data-height</span><span class="o">=</span><span class="s">&quot;265&quot;</span> <span class="na">data-theme-id</span><span class="o">=</span><span class="s">&quot;light&quot;</span> <span class="na">data-default-tab</span><span class="o">=</span><span class="s">&quot;html,result&quot;</span> <span class="na">data-user</span><span class="o">=</span><span class="s">&quot;chuckpr&quot;</span> <span class="na">data-slug-hash</span><span class="o">=</span><span class="s">&quot;QWjgVWV&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;&quot;</span> <span class="na">data-pen-title</span><span class="o">=</span><span class="s">&quot;wireless-signal&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>See the Pen <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr/pen/QWjgVWV&quot;</span><span class="p">&gt;</span>
  wireless-signal<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> by Charles Pepe-Ranney (<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io/chuckpr&quot;</span><span class="p">&gt;</span>@chuckpr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)
  on <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://codepen.io&quot;</span><span class="p">&gt;</span>CodePen<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://static.codepen.io/assets/embed/ei.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<p class="codepen" data-height="265" data-theme-id="light" data-default-tab="html,result" data-user="chuckpr" data-slug-hash="QWjgVWV" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="wireless-signal">
  <span>See the Pen <a href="https://codepen.io/chuckpr/pen/QWjgVWV">
  wireless-signal</a> by Charles Pepe-Ranney (<a href="https://codepen.io/chuckpr">@chuckpr</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered celltag_hide-all">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">fivethirtyeight</span><span class="o">.</span><span class="n">tpl</span>

<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;polls3&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">table</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">thead</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;&lt;</span><span class="n">div</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>
                   <span class="n">style</span><span class="o">=</span><span class="s2">&quot;text-align: center&quot;</span>
                 <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{{</span><span class="n">c</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;rotate&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">svg</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;max-width: none;&quot;</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">text</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(25,60)rotate(-45)&quot;</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]}}</span><span class="o">&lt;/</span><span class="n">text</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">line</span> <span class="n">x1</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y1</span><span class="o">=</span><span class="s2">&quot;65&quot;</span> <span class="n">x2</span><span class="o">=</span><span class="s2">&quot;25&quot;</span> <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;40&quot;</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(41.5,0)&quot;</span><span class="o">&gt;&lt;/</span><span class="n">line</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">svg</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;rotate&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">svg</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;82&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;max-width: none;&quot;</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="n">text</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;translate(25,60)rotate(-45)&quot;</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">]}}</span><span class="o">&lt;/</span><span class="n">text</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">svg</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;width: 20px&quot;</span><span class="o">&gt;&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">c</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
      <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">thead</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">tbody</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="o">%</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;dates&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">dates</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;justtext&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">pollster</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;grade&quot;</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">grade</span> <span class="o">%</span><span class="p">}</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;grade-circ&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;border-color: green&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;position: relative; top: 25%&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">grade</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;grade-circ&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;border-color: white&quot;</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>    
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;sample&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;sample-number&quot;</span><span class="o">&gt;</span>
            <span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">sample</span><span class="p">}}</span><span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;color: #999&quot;</span><span class="o">&gt;&amp;</span><span class="n">nbsp</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">population</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;signal&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> 
             <span class="n">style</span><span class="o">=</span><span class="s2">&quot;height: 20%; background: {</span><span class="si">% i</span><span class="s2">f row.weight &lt; 0.01 %}lightgray{</span><span class="si">% e</span><span class="s2">lse %}gray{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> 
             <span class="n">style</span><span class="o">=</span><span class="s2">&quot;height: 40%; background: {</span><span class="si">% i</span><span class="s2">f row.weight &lt; 0.044 %}lightgray{</span><span class="si">% e</span><span class="s2">lse %}gray{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> 
             <span class="n">style</span><span class="o">=</span><span class="s2">&quot;height: 60%; background: {</span><span class="si">% i</span><span class="s2">f row.weight &lt; 0.087 %}lightgray{</span><span class="si">% e</span><span class="s2">lse %}gray{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> 
             <span class="n">style</span><span class="o">=</span><span class="s2">&quot;height: 80%; background: {</span><span class="si">% i</span><span class="s2">f row.weight &lt; 1.3 %}lightgray{</span><span class="si">% e</span><span class="s2">lse %}gray{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> 
             <span class="n">style</span><span class="o">=</span><span class="s2">&quot;height: 100%; background: {</span><span class="si">% i</span><span class="s2">f row.weight &lt; 1.7 %}lightgray{</span><span class="si">% e</span><span class="s2">lse %}gray{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;margin-right: 10px&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">weight</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;heat&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;background-color: {{row.r_color}}&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">republican</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;heat&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;background-color: {{row.d_color}}&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">democrat</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;min-width: 10px;&quot;</span><span class="o">&gt;&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;just-text&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">leader</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;adj-leader&quot;</span> 
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;color: {</span><span class="si">% i</span><span class="s2">f row.adj_leader.startswith(&#39;D&#39;) %}#008fd5{</span><span class="si">% e</span><span class="s2">lse %}#ff9371{</span><span class="si">% e</span><span class="s2">ndif %}&quot;</span><span class="o">&gt;</span>
          <span class="p">{{</span><span class="n">row</span><span class="o">.</span><span class="n">adj_leader</span><span class="p">}}</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;/</span><span class="n">tbody</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>

<span class="n">div</span> <span class="o">.</span><span class="n">polls3</span> <span class="p">{</span>
    <span class="n">overflow</span><span class="p">:</span> <span class="n">scroll</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">top</span><span class="p">:</span> <span class="mi">6</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="p">{</span>
    <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="s1">&#39;helvetica neue&#39;</span><span class="p">,</span> <span class="n">helvetica</span><span class="p">,</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">12</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="mi">500</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">collapse</span><span class="p">:</span> <span class="n">collapse</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">spacing</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="p">{</span>
    <span class="n">border</span><span class="o">-</span><span class="n">bottom</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#222;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">transform</span><span class="p">:</span> <span class="n">uppercase</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="mi">500</span><span class="p">;</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">bottom</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">left</span> <span class="err">!</span><span class="n">important</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span> <span class="p">{</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">41</span><span class="n">px</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">relative</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span><span class="o">&gt;</span><span class="n">div</span> <span class="p">{</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">absolute</span><span class="p">;</span>
    <span class="n">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">thead</span> <span class="n">tr</span> <span class="n">th</span><span class="o">.</span><span class="n">rotate</span><span class="o">&gt;</span><span class="n">div</span> <span class="n">svg</span> <span class="n">line</span> <span class="p">{</span>
    <span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">stroke</span><span class="p">:</span> <span class="c1">#cdcdcd;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span> <span class="p">{</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">middle</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">dates</span> <span class="p">{</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">90</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">11</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">transform</span><span class="p">:</span> <span class="n">uppercase</span><span class="p">;</span>
    <span class="n">color</span><span class="p">:</span> <span class="c1">#999;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">just</span><span class="o">-</span><span class="n">text</span> <span class="p">{</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">80</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">grade</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">center</span><span class="p">;</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#222;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">70</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">70</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">11</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">grade</span><span class="o">&gt;</span><span class="n">div</span> <span class="p">{</span>
    <span class="n">border</span><span class="p">:</span> <span class="mi">2</span><span class="n">px</span> <span class="n">solid</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">radius</span><span class="p">:</span> <span class="mi">50</span><span class="o">%</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="n">bold</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="n">auto</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="n">auto</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">sample</span> <span class="p">{</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="s2">&quot;DecimaMonoPro&quot;</span><span class="p">,</span> <span class="n">monospace</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">transform</span><span class="p">:</span> <span class="n">uppercase</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">weight</span> <span class="p">{</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="s2">&quot;DecimaMonoPro&quot;</span><span class="p">,</span> <span class="n">monospace</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">90</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">90</span><span class="n">px</span><span class="p">;</span>
    <span class="n">border</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#222;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">transform</span><span class="p">:</span> <span class="n">uppercase</span><span class="p">;</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">signal</span> <span class="p">{</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">35</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">18</span><span class="n">px</span><span class="p">;</span>
    <span class="n">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">display</span><span class="p">:</span> <span class="n">table</span><span class="p">;</span>
    <span class="nb">float</span><span class="p">:</span> <span class="n">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">bar</span> <span class="p">{</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="o">%</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">vertical</span><span class="p">:</span> <span class="n">align</span><span class="o">-</span><span class="n">bottom</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">12</span><span class="o">%</span><span class="p">;</span>
    <span class="n">display</span><span class="p">:</span> <span class="n">inline</span><span class="o">-</span><span class="n">block</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">heat</span> <span class="p">{</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">heat</span><span class="o">&gt;</span><span class="n">div</span> <span class="p">{</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">40</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">40</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">50</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="s2">&quot;DecimaMonoPro&quot;</span><span class="p">,</span> <span class="n">monospace</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
    <span class="n">display</span><span class="p">:</span> <span class="n">table</span><span class="o">-</span><span class="n">cell</span><span class="p">;</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">middle</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">polls3</span> <span class="n">table</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">td</span><span class="o">.</span><span class="n">adj</span><span class="o">-</span><span class="n">leader</span> <span class="p">{</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="nb">min</span><span class="o">-</span><span class="n">width</span><span class="p">:</span> <span class="mi">65</span><span class="n">px</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">left</span><span class="p">;</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">left</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting fivethirtyeight.tpl
</pre>
</div>
</div>

</div>
</div>

</div>
 


    </section>
<div id="disqus_thread" class="mt4">
</div>
<script>

  var disqus_config = function () {
    this.page.url = 'https://chuckpr.github.io/posts/fivethirtyeight-tables/';
    this.page.identifier = 'posts/fivethirtyeight-tables/';
  };

  (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://chuckpr-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();

</script>
<noscript>
  Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">
    comments powered by Disqus.
  </a>
</noscript>  </article>
  </main>
  <footer class="pv3 flex justify-between mt4 mb2 mw7 ml-auto mr-auto avenir">
    <div class="flex flex-column pl3">
      <div class="mid-gray fw4 f6-ns f7 mb2">
        Copyright &copy; 2020 Chuck&nbsp;Pepe&#8209;Ranney
      </div>
      <div class="mid-gray" style="font-size: 0.65rem;">
        Powered&nbsp;by&nbsp;<a href="https://getpelican.com/" class="link dim
          mid-gray f6 fw6">Pelican</a>,
        Theme&nbsp;by&nbsp;<a href="https://github.com/chuckpr/simple-pelican-blog-theme"
          class="link dim mid-gray fw6">@chuckpr</a>
      </div>
    </div>
    <div class="flex justify-end w-50-ns w-30 mr4-ns mr0 ml2">
            <div class="w-10-ns w2 ml2 grow">
              <a href="https://github.com/chuckpr" class="light-purple dim link">
                <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>GitHub icon</title>
  <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
</svg>                </div>
              </a>
            </div>
            <div class="w-10-ns w2 ml2 grow">
              <a href="https://www.linkedin.com/in/chuckpr/" class="light-purple dim link">
                <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>LinkedIn icon</title>
  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
</svg>                </div>
              </a>
            </div>
            <div class="w-10-ns w2 ml2 grow">
              <a href="https://twitter.com/chuck_pr" class="light-purple dim link">
                <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>Twitter icon</title>
  <path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/>
</svg>                </div>
              </a>
            </div>
    </div>
  </footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>

  console.log('Adding toggle buttons');
  var $toggleCodeButton = $('\
    <a class="toggle toggle-code" href="#0">\
      toggle code\
    </a>\
  ')

  var $toggleAllButton = $('\
    <div>\
      <a class="toggle toggle-all" href="#0">\
        show me\
      </a>\
    </div>\
  ')

  // This adds the buttons
  $(document).ready(function(){

    $cellToggleCode = $('.celltag_toggle_code')
    $cellToggleCode.find('.input').css('display', 'none');
    $toggleCodeButton.prependTo($cellToggleCode);

    $cellToggleAll = $('.celltag_toggle_all');
    $cellToggleAll.css('display', 'none');
    $toggleAllButton.insertBefore($cellToggleAll);

    $('.celltag_disappear').css('display', 'none');

  });

  // These add the toggle behavior for the buttons
  $(document).ready(function(){
    $('a.toggle-code').click(function(){
      $(this).next('.input').slideToggle();
    });
  })

  $(document).ready(function(){
    $('a.toggle-all').click(function(){
      $(this).parent().next('div').slideToggle();
    });
  })

</script></body>

</html>