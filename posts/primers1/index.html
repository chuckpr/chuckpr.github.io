<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:creator" content="@chuckpr"/>
  <link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css"/>

  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/article.css">
  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/notebook.css">
  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="https://chuckpr.github.io/theme/css/site.css">
</head>

<body>
  <div class="mw7 avenir ml-auto mr-auto ph3 flex flex-column min-vh-100">
    <div id="header" class="flex flex-column">
<div class="pt5 pb2">
  <a href="https://chuckpr.github.io/" class="link dim f2 fw4 blue tracked-tight bb-ns bw1-ns lh-title b--moon-gray">
    A microbiologist with a data science problem
  </a>
</div>    </div>
    <div id="content" class="flex-auto mb5">
  <div class="flex flex-column">
    <div class="flex justify-between items-center article-title bb bw1 b--light-gray">
      <div>
        <div class="flex flex-column">
          <div>
            <p class="f3-ns f4 mv0 lh-title">
              Exploring 515F primer targets in archaeal and bacterial SSU rRNA genes
            </p>
          </div>
          <div class="ml3">
            <p class="f6 ttc mb0 mt1 mid-gray">
              Tue 14 April 2015
            </p>
          </div>
        </div>
      </div>
      <div class="w-40">
        <div class="flex flex-wrap justify-end">
<div class="mv1 mr2 bg-light-green br3 pa2 grow">
  <a href="https://chuckpr.github.io/tag/r" class="link dark-pink underline-hover fw5">
      #R
  </a>
</div><div class="mv1 mr2 bg-light-green br3 pa2 grow">
  <a href="https://chuckpr.github.io/tag/python" class="link dark-pink underline-hover fw5">
      #Python
  </a>
</div><div class="mv1 mr2 bg-light-green br3 pa2 grow">
  <a href="https://chuckpr.github.io/tag/amplicon" class="link dark-pink underline-hover fw5">
      #amplicon
  </a>
</div>        </div>
      </div>
    </div>
    <div class="ph3">
      <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Microbial ecologists have long considered the 515F SSU rRNA gene PCR primer to be "universal." That is, the 515F primer is thought to amplify Eukarya, Archaea, and Bacteria. Indeed the target of the 515F primer is well conserved across each domain, however, the there are some differences in the primer target between domains that should be considered when evaluating 515F for use in a microbial diversity studies.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make matters more complicated the 515F primer has changed from its inception to account for new sequence information and it's not clear from the literature which 515F version is most effective. <em>In this post, we'll take a look at tbe 515F primer target across a broad diversity of SSU rRNA genes</em>. In subsequent posts we'll evaluate different 515F versions and we'll also evaluate reverse primers that can be paired with 515F. While there are excellent tools avaliable for SSU rRNA gene PCR primer analysis (see <a href="http://pprospector.sourceforge.net/">PrimerProspector</a>, <a href="http://www.arb-silva.de/search/testprime/">TestPrime</a>), most tools focus on nucleotide frequecies in aligments. In this post, we'll evaluate 515F by looking at the distribution of 515F target oligos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the 99% OTU seed sequences for the GreenGenes database as reference. You can download the GreenGenes files from <a href="http://greengenes.secondgenome.com/downloads/database/13_5">here</a>. This analysis will focus on Archaea and Bacteria.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we need to import some python functions and modules as well as load some extensions for the IPython notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">rpy2</span><span class="o">.</span><span class="n">ipython</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">align</span> <span class="kn">import</span> <span class="n">aligner</span>
<span class="kn">from</span> <span class="nn">skbio</span> <span class="kn">import</span> <span class="n">DNA</span><span class="p">,</span> <span class="n">parse_fasta</span><span class="p">,</span> <span class="n">SequenceCollection</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Eventually we'll want to explore target sites by their taxonomic affiliation so we need to get the taxonomic information from the GreenGenes files we downloaded (above). The following code is a quick and dirty way to populate a <a href="http://pandas.pydata.org/">pandas</a> DataFrame with the taxonomic annotations for the gene sequences we'll be working with.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">parse_tax</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">,</span> <span class="n">tax_str</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">tax_str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
    <span class="n">tax_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;kingdom&quot;</span> <span class="p">:</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;phylum&quot;</span>  <span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;class&quot;</span>   <span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;family&quot;</span>  <span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;order&quot;</span>   <span class="p">:</span> <span class="n">o</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;genus&quot;</span>   <span class="p">:</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;species&quot;</span> <span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;id&quot;</span>      <span class="p">:</span> <span class="nb">id</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">tax_dict</span>
    

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">([</span><span class="n">parse_tax</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> 
                                <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/gg_13_5_otus/taxonomy/99_otu_taxonomy.txt&quot;</span><span class="p">)])</span>

<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have the taxonomy for each sequence, let's get the 515F target site. To do this we just align one combination of the degenerate 515F primer to each SSU rRNA gene sequence. We then pull out the aligned region from the SSU rRNA gene sequence -- this is the 515F target! I'm using the <code>glocal</code> method for the <code>Python</code> <a href="https://github.com/brentp/align">aligner</a> package for the alignment and I'm using <a href="http://scikit-bio.org/">scikit-bio</a> to parse and manage the SSU rRNA gene sequenes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">fn</span> <span class="o">=</span> <span class="s2">&quot;data/gg_13_5_otus/rep_set/99_otus.fasta&quot;</span>
<span class="n">degens</span> <span class="o">=</span> <span class="n">DNA</span><span class="o">.</span><span class="n">iupac_degenerate_characters</span><span class="p">()</span>
<span class="n">seqs</span> <span class="o">=</span> <span class="n">SequenceCollection</span><span class="o">.</span><span class="n">from_fasta_records</span><span class="p">([(</span><span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">parse_fasta</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> 
                                              <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">degens</span><span class="p">)],</span> 
                                             <span class="n">DNA</span><span class="p">)</span>

<span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seqs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">F515</span> <span class="o">=</span> <span class="n">DNA</span><span class="p">(</span><span class="s2">&quot;GTGCCAGCCGCCGCGGTAA&quot;</span><span class="p">)</span> <span class="c1">#GTGCCAGCMGCCGCGGTAA  M = [CA]</span>

<span class="n">primer_targets_515</span> <span class="o">=</span> <span class="p">[</span><span class="n">aligner</span><span class="p">(</span><span class="n">F515</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> 
                              <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span>
                              <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;glocal&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
                      <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seqs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 20min 29s, sys: 112 ms, total: 20min 30s
Wall time: 20min 31s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can join our target and taxonomy information into a single DataFrame. Each row represents one target from one gene. Specifically, each row has the target sequence and corresponding taxonomic information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">df_targets</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">primer_targets_515</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;515F&quot;</span><span class="p">),</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">df_targets</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;515F&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I love <a href="http://pandas.pydata.org/">pandas</a> but I think for this application it will be best to use the (mind-blowingly amazing) R package <a href="http://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">dplyR</a>. So, we need to push our pandas DataFrame into  an R session. I'm using the <code>rmagic</code> functions from <a href="http://ipython.org/">IPython</a>/<a href="http://rpy.sourceforge.net/">rpy2</a> to move from Python to R.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">df_targets</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Attaching package: ‘dplyr’

The following object is masked from ‘package:stats’:

    filter

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, now we can make some figures! Let's first look at the ten most abundant archaeal and bacterial 515F targets. You can see below that the bacterial 515F targets are dominated by a single sequence, and, that although the nineteen targets are similar in sequence there is little overlap in target representation between Archaea and Bacteria.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">600</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">df_targets</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">kingdom</span><span class="p">,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">ties.method</span> <span class="o">=</span> <span class="s">&quot;random&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="m">10</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">kingdom</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">X515F</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">X515F</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">.$X515F</span><span class="p">)))</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X515F</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">count</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">kingdom</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;#14979B&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">scale_y_log10</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">),</span>
              <span class="n">strip.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">strip.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">))</span>
                                    
<span class="n">p</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="https://chuckpr.github.io/notebooks/images/primers1_16_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we dig a little deeper into to archaeal 515F targets, we see some interesting trends among phyla. There are very few Nanoarchaea sequences in the reference database but they all have the same 515F target sequence which appears to be unique to Nanoarchaea. Also, there are a couple relatively abundant 515F target sequences with insertions. Eight of the ten most abundant archaeal 515F targets are identical over the last six nucleotides at the 3' end of the 515F primer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">h</span> <span class="m">550</span> <span class="o">-</span><span class="n">w</span> <span class="m">400</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">df_targets</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">kingdom</span> <span class="o">==</span> <span class="s">&quot;Archaea&quot;</span><span class="p">,</span> <span class="n">phylum</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="p">{</span>
        <span class="n">top10</span> <span class="o">=</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
            <span class="nf">filter</span><span class="p">(</span><span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">ties.method</span> <span class="o">=</span> <span class="s">&quot;random&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="m">10</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;X515F&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
            <span class="n">unique</span> <span class="o">%&gt;%</span>
            <span class="n">as.character</span>
        <span class="nf">filter</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span> <span class="o">%in%</span> <span class="n">top10</span><span class="p">)</span> 
    <span class="p">}</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">phylum</span><span class="p">,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="p">{</span>
        <span class="n">psort</span> <span class="o">=</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">summarize</span><span class="p">(</span><span class="n">S</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="o">%&gt;%</span>
            <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">S</span><span class="p">))</span> <span class="o">%&gt;%</span>
            <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;X515F&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">as.character</span>
        <span class="nf">mutate</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">X515F</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">psort</span><span class="p">))</span>
    <span class="p">}</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X515F</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">count</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">phylum</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;#14979B&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">scale_y_log10</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">),</span>
              <span class="n">strip.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">strip.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">))</span>

<span class="n">p</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="https://chuckpr.github.io/notebooks/images/primers1_18_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Bacteria appear to be dominated by a single target sequence (above). Let's get that sequence explicitly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">max.target</span> <span class="o">=</span> <span class="n">df_targets</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">kingdom</span> <span class="o">==</span> <span class="s">&quot;Bacteria&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;X515F&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">as.character</span>

<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;The most abundant target sequence among bacteria is&quot;</span><span class="p">,</span> <span class="n">max.target</span><span class="p">)</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>[1] &#34;The most abundant target sequence among bacteria is GTGCCAGCAGCCGCGGTAA&#34;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are some phyla, however, that are not as dominated by the most abundant bacterial 515F target. Here is a histogram of representation (percentages of total targets) within phylum for the most abundant bacterial 515F target. You can see that there are nine phyla for which the most abundant 515F bacterial target represents less than 80% of total targets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">h</span> <span class="m">350</span>
<span class="n">df_targets</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">kingdom</span> <span class="o">==</span> <span class="s">&quot;Bacteria&quot;</span><span class="p">,</span> <span class="n">phylum</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">phylum</span><span class="p">,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">phylum</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">count.relative</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">X515F</span> <span class="o">==</span> <span class="n">max.target</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;count.relative&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">hist</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span>
                                        <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Histogram of most abundant target representation in phlya&quot;</span><span class="p">)</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="https://chuckpr.github.io/notebooks/images/primers1_22_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see what the 515F targets look like for those nine phyla (above). The plot below shows the five most abundant 515F targets ranked by max representation within a phylum for the nine selected phyla. You can see that FCPU426, WS5, and GN01 515F targets are still dominated by the most abundant 515F target across all bacteria (GTGCCAGCAGCCGCGGTAA). The TM7 phylum 515F targets differ from the most abundant target at the 3' end of the 515F primer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">600</span> <span class="o">-</span><span class="n">h</span> <span class="m">500</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">df_targets</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">kingdom</span> <span class="o">==</span> <span class="s">&quot;Bacteria&quot;</span><span class="p">,</span> <span class="n">phylum</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">phylum</span><span class="p">,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarize</span><span class="p">(</span><span class="n">count</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">phylum</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">count.relative</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="p">{</span>
        <span class="n">keep</span> <span class="o">=</span> <span class="nf">filter</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span> <span class="o">==</span> <span class="n">max.target</span><span class="p">,</span> <span class="n">count.relative</span> <span class="o">&lt;=</span> <span class="m">0.80</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;phylum&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
            <span class="n">unique</span> <span class="o">%&gt;%</span>
            <span class="n">as.character</span>
        <span class="nf">filter</span><span class="p">(</span><span class="n">.,</span> <span class="n">phylum</span> <span class="o">%in%</span> <span class="n">keep</span><span class="p">)</span>
    <span class="p">}</span> <span class="o">%&gt;%</span>
    <span class="p">{</span>
        <span class="n">top</span> <span class="o">=</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">summarize</span><span class="p">(</span><span class="n">m</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">count.relative</span><span class="p">))</span> <span class="o">%&gt;%</span>
            <span class="nf">filter</span><span class="p">(</span><span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">ties.method</span> <span class="o">=</span> <span class="s">&quot;random&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="m">5</span><span class="p">)</span> <span class="o">%&gt;%</span>
            <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">%&gt;%</span>
            <span class="nf">extract2</span><span class="p">(</span><span class="s">&quot;X515F&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
            <span class="n">unique</span> <span class="o">%&gt;%</span>
            <span class="n">as.character</span>
        <span class="nf">filter</span><span class="p">(</span><span class="n">.,</span> <span class="n">X515F</span> <span class="o">%in%</span> <span class="n">top</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">X515F</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">X515F</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">top</span><span class="p">))</span>
    <span class="p">}</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X515F</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">count.relative</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">phylum</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;#14979B&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">65</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">),</span>
              <span class="n">strip.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">strip.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">))</span>

<span class="n">p</span>
<span class="c1"># &lt;!-- collapse=True --&gt;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="https://chuckpr.github.io/notebooks/images/primers1_24_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I would guess that these nine phyla are the most likely to be missed by commonly used variants of 515F primers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="In-the-next-post-we'll-test-that-hypothesis-by-evaluating-how-well-the-515F-primer-matches-the-targets-we've-identified...">In the next post we'll test that hypothesis by evaluating how well the 515F primer matches the targets we've identified...<a class="anchor-link" href="#In-the-next-post-we'll-test-that-hypothesis-by-evaluating-how-well-the-515F-primer-matches-the-targets-we've-identified...">&#182;</a></h4>
</div>
</div>
</div>
 


    </div>
<div id="disqus_thread" class="mt4">
</div>
<script>

  var disqus_config = function () {
    this.page.url = 'https://chuckpr.github.io/posts/primers1/';
    this.page.identifier = 'posts/primers1/';
  };

  (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://chuckpr-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();

</script>
<noscript>
  Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">
    comments powered by Disqus.
  </a>
</noscript>  </div>
    </div>
    <div id="footer" class="pv3 flex justify-between mb4">
      <div class="flex flex-column">
        <div class="mid-gray fw4 f6-ns f7 mb2">
          Copyright &copy; 2020 Chuck&nbsp;Pepe&#8209;Ranney
        </div>
        <div class="mid-gray fw4 f6-ns f7">
          Powered by <a href="https://getpelican.com/" class="link dim mid-gray fw6">Pelican</a>
        </div>
      </div>
      <div class="flex justify-end w-50-ns w-30 mr4-ns mr0 ml2">
              <div class="w-10-ns w2 ml2 grow">
                <a href="https://github.com/chuckpr" class="light-purple dim link">
                  <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>GitHub icon</title>
  <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
</svg>                  </div>
                </a>
              </div>
              <div class="w-10-ns w2 ml2 grow">
                <a href="https://www.linkedin.com/in/chuckpr/" class="light-purple dim link">
                  <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>LinkedIn icon</title>
  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
</svg>                  </div>
                </a>
              </div>
              <div class="w-10-ns w2 ml2 grow">
                <a href="https://twitter.com/chuck_pr" class="light-purple dim link">
                  <div class="o-50 pa1-l">
<svg viewBox="0 0 24 24" fill="currentColor">
  <title>Twitter icon</title>
  <path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/>
</svg>                  </div>
                </a>
              </div>
      </div>
    </div>
  </div>
</body>

</html>